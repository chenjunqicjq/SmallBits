# 内存泄漏和内存溢出

## 内存泄漏

**内存泄漏**：指程序在申请内存后，无法释放申请的内存空间。简单来说就是程序申请了内存空间，但是却没有进行释放，那么该空间将一直被占用，若出现占用的空间比较多，会导致可以使用的内存空间变小。

**以发生方式分类**

1.一次性内存泄漏：发生内存泄漏的代码只会执行一次，或者由于算法的缺陷，但是泄漏的内存有且只有一块。比如只有构造函数而没有析构函数。

2.偶发性内存泄漏：发生内存泄漏的代码只有在某些特定的操作步骤或环境下才会被执行。

3.常发性内存泄漏：发生内存泄漏的代码被经常执行，每次执行都有一块内存被泄漏。

4.隐式内存泄漏：程序在运行过程中一直分配内存，一直到程序结束才释放内存。这并不是内存泄漏，但有些程序可能需要运行几天，几个月，一直未结束，那么内存的堆积也是很多的。所有称为隐式内存泄漏。

## 内存溢出

**内存溢出**：当程序在申请内存时，没有足够的内存空间供其使用。简单来说就是内存空间不能满足程序所需要的空间。

**导致内存泄漏的常见原因**：

1.从内存加载的数据量过大，如从数据库中一次性查询的内容太多

2.对象实体使用后未释放引用，不能被回收

3.代码中有死循环或者循环产生太多重复的对象实体 

4.内存参数设置的过小

**解决方案**：

1.调整内存参数大小

2.检查错误日志，查看日志信息

3.分析代码排查：查看是否一次性从数据库中查询太多数据，可以使用分页查询；查看是不是有死循环或者特别深的递归调用；查看集合中引用的对象使用后是否被回收；

# 其他

**堆内存溢出：**当出现堆内存溢出异常时，可以先使用工具分析对象是否有必要存在，如果对象没有必要存在，那么根据工具显示查找到该对象的引用链，然后定位到相关代码；如果是有必要存在，那么可以考虑调大堆内存空间。

**栈内存溢出：**栈内存的大小为进程的内存大小减去堆内存减去方法区内存。当线程数变多，则栈内存变少；线程数变少，则栈内存变多。





















