# Redis基础之事务

## 事务的实现

Redis的事务由MULTI命令开启，EXEC命令结束。

Redis提供一种将多个命令请求进行打包，然后统一依次执行，并且保证在执行事务时服务端不会中断而去执行客户端的其他请求命令。

在执行一个事务时，当写入命令时并不会直接执行，而是先加入到一个事务队列中，该队列实行先进先出原则；当EXEC命令执行后，从队列中一次取出命令执行。

## 使用WATCH命令来保证事务的安全性

事务的安全性同过WATCH命令来保证，在事务的MULTI执行前，使用WATCH命令来监视一个键，在执行EXEC命令后，会进行检查监视的键是否被其他客户端进行过修改，若发现修改，则返回一个错误，则事务执行失败。

WATCH通过一个监视字典来检查键是否修改。在字典中每个键相对应的保存监视了他的数据库的编号。如  “name”键被数据库1，2，监视，当其他数据库进行修改值时会触发修改，则将数据库1，2的事务安全被破坏的属性赋值，则导致数据库1，2的事务执行失败。

**Redis的事务并不支持事务回滚**，当一次事务中的命令有多条，但其中一条执行失败，其他的命令依然执行，并且执行成功，并不会因为有失败的命令而进行事务回滚。







































